<mat-sidenav-container fullscreen [hasBackdrop]="false" *transloco="let t; read: 'EXAMS'">
    <div class="relative flex flex-col flex-auto min-w-0 overflow-hidden">

        <!-- Header -->
        <div
            class="flex flex-col sm:flex-row flex-0 sm:items-center sm:justify-between p-6 sm:py-3 sm:px-10 border-b bg-card dark:bg-transparent">
            <div class="flex-1 min-w-0">
                <!-- Breadcrumbs -->

                <!-- Title -->

                <div class="mt-2">
                    <h2 class="text-3xl md:text-4xl font-extrabold tracking-tight leading-7 sm:leading-10 truncate">
                        {{t('Exams')}}
                    </h2>
                </div>
            </div>
            <div class="flex items-center justify-end">
                <div class="example-header">
                    <mat-form-field>
                        <mat-icon>search</mat-icon>
                        <input matInput (keyup)="applyFilter($event.target.value)" placeholder="{{t('SEARCH')}}">
                    </mat-form-field>
                </div>
            </div>

            <button mat-flat-button="" type="button" (click)="sidenav.toggle();addDialog()"
                class="mat-focus-indicator ml-4 mat-flat-button mat-button-base mat-primary"
                style="background: #941C3C;"><span class="mat-button-wrapper"> <mat-icon class="material-icons">
                        add
                    </mat-icon> {{t('Add Exams')}} </span></button>
        </div>



        <!-- Header & Cards -->
        <div class="relative pb-12 sm:pt-0 sm:pb-2 px-6 sm:px-6 overflow-hidden">
            <!-- Card -->
            <div class="flex flex-col items-center mt-10 sm:mt-5">
                <fuse-card class="flex-col lg:flex-row w-full lg:max-w-7xl overflow-x-auto overflow-y-hidden">

                    <div class="grid grid-flow-col lg:grid-flow-row min-w-max lg:min-w-0 divide-x lg:divide-x-0 lg:divide-y"
                        style="width: 100%">

                        <div class="example-loading-shade" style="margin: auto;margin-top: 50px;" *ngIf="loading && sortBool">
                            <mat-spinner *ngIf="loading" class="orange-spinner"></mat-spinner>
                            
                        </div>
                <div class="mat-elevation-z8">
                        <!-- <div class="mat-elevation-z8"> -->
                    <div  *ngIf="(data1 | async) as dataLoaded ">
                        <table mat-table [dataSource]="dataLoaded?.courseSessionQuestionDataForWebBeans" style="width: 100%"  matSort matSortActive="title"
                        matSortDisableClear matSortDirection="desc" (matSortChange)="applySort($event)">

                            <ng-container matColumnDef="title">
                                <th mat-header-cell *matHeaderCellDef mat-sort-header disableClear>{{t('Exam Name')}}</th>
                                <td matTooltip ="{{element.title}}"  [routerLink]="['/apps/questions/examsets/'+element.id]" mat-cell *matCellDef="let element">
                                    {{((element.title).length > 10) ? ((element.title).slice(0, 10) + '...') : element.title}}
                                </td>
                            </ng-container>
                            <ng-container matColumnDef="examId">
                                <th mat-header-cell *matHeaderCellDef mat-sort-header disableClear>{{t('Exam Id')}} </th>
                                <td matTooltip ="{{element.examDetailId}}" [routerLink]="['/apps/questions/examsets/'+element.id]"  mat-cell *matCellDef="let element"> {{element.examDetailId}}</td>
                            </ng-container>

                            <ng-container matColumnDef="courseEntity">
                                <th mat-header-cell *matHeaderCellDef mat-sort-header disableClear>{{t('Course Name')}}</th>
                                <td matTooltip ="{{element.course}}" [routerLink]="['/apps/questions/examsets/'+element.id]"  mat-cell *matCellDef="let element">
                                    {{((element.course).length > 10) ? ((element.course).slice(0, 10) + '...') : element.course}}
                                </td>
                            </ng-container>

                            <!-- <ng-container matColumnDef="examDuration">
                                <th mat-header-cell *matHeaderCellDef mat-sort-header>Exam Duration</th>
                                <td [routerLink]="['/apps/questions/questions-detail/'+element.id]"  mat-cell *matCellDef="let element"> {{element.examDuration}} min </td>
                            </ng-container> -->


                            <!-- <ng-container matColumnDef="examNoQuestion">
                                <th mat-header-cell *matHeaderCellDef mat-sort-header>No. Question</th>
                                <td mat-cell *matCellDef="let element"> {{element.examNoQuestion}} </td>
                            </ng-container> -->
                            <ng-container matColumnDef="examStartOn">
                                <th mat-header-cell *matHeaderCellDef mat-sort-header disableClear>{{t('Exam Start Date')}}</th>
                                <td matTooltip ="{{element.examStartOnStr}}" [routerLink]="['/apps/questions/examsets/'+element.id]"  mat-cell *matCellDef="let element"> {{element.examStartOnStr}}
                                </td>
                            </ng-container>

                            <ng-container matColumnDef="examStartTimeOn">
                                <th mat-header-cell *matHeaderCellDef mat-sort-header disableClear>{{t('Exam Time')}}</th>
                                <td matTooltip ="{{element.examStartTimeOn}}" [routerLink]="['/apps/questions/examsets/'+element.id]"  mat-cell *matCellDef="let element">{{element.examStartTimeOn}}</td> 
                            </ng-container>

                           <!-- <ng-container matColumnDef="examStartTimeOn">
                                <th mat-header-cell *matHeaderCellDef mat-sort-header>Exam Start Time</th>
                                <td mat-cell *matCellDef="let element"> {{(element.examStartTimeOn !== null) ?
                                    (element.examStartTimeOn | datepipe):""}} </td>
                            </ng-container> -->
                                <!-- 
                            <ng-container matColumnDef="examEndTimeOn">
                                <th mat-header-cell *matHeaderCellDef mat-sort-header>Exam End Time</th>
                                <td mat-cell *matCellDef="let element"> {{(element.examEndTimeOn !== null) ?
                                    (element.examEndTimeOn | datepipe):""}} </td>
                            </ng-container> -->
                            <!-- <ng-container matColumnDef="question">
                                    <th mat-header-cell *matHeaderCellDef mat-sort-header>Question</th>
                                    <td mat-cell *matCellDef="let element"></td>
                                </ng-container> -->

                            <!-- <ng-container matColumnDef="option">
                                    <th mat-header-cell *matHeaderCellDef mat-sort-header>Answer Option</th>
                                    <td mat-cell *matCellDef="let element"></td>
                                </ng-container> -->

                            <ng-container matColumnDef="edit">
                                <th mat-header-cell *matHeaderCellDef> {{t('Action')}}</th>
                                <td mat-cell *matCellDef="let element">
                                    <!-- <button class="hover:bg-green-200" mat-icon-button matTooltip="Add">
                                        <mat-icon class="hover:text-green-600"
                                            [svgIcon]="'heroicons_outline:external-link'"
                                            (click)="addByZillow(zillowTemplate)"></mat-icon>
                                    </button>&nbsp; -->

                                    <span *ngIf="!element.started">
                                        <button  matTooltip="{{t('Start')}}" (click)="OpenStartExamPopup(startexampopup,element.id,element)"> <span
                                            class="mat-button-wrapper"><mat-icon role="img"
                                                class="mat-icon notranslate text-blue-600 mat-icon-no-color"
                                                aria-hidden="true" data-mat-icon-type="svg"
                                                data-mat-icon-name="pencil-alt"
                                                data-mat-icon-namespace="heroicons_outline">
                                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="#941C3C" className="w-6 h-6">
                                                    <path strokeLinecap="round" strokeLinejoin="round" d="M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.348a1.125 1.125 0 010 1.971l-11.54 6.347a1.125 1.125 0 01-1.667-.985V5.653z" />
                                                  </svg>
                                                      
                                        </mat-icon></span></button>
                                    </span>

                                    <button  matTooltip="{{t('Edit')}}" (click)="sidenav.open();editdialog(element)"> <span
                                            class="mat-button-wrapper"><mat-icon role="img"
                                                class="mat-icon notranslate text-blue-600 mat-icon-no-color"
                                                aria-hidden="true" data-mat-icon-type="svg"
                                                data-mat-icon-name="pencil-alt"
                                                data-mat-icon-namespace="heroicons_outline">
                                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                                                    stroke="#941C3C" fit="" height="100%" width="100%"
                                                    preserveAspectRatio="xMidYMid meet" focusable="false">
                                                    <path stroke-linecap="round" stroke-linejoin="round"
                                                        stroke-width="2"
                                                        d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z">
                                                    </path>
                                                </svg></mat-icon></span></button>
                                               
                                    <!-- <button matTooltip="{{t('Delete')}}" (click)="openSubPopUp(content,element.id)" style="color: #941C3C;"><i
                                            class="material-icons">delete</i></button> -->
                                </td>
                            </ng-container>

                            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
                        </table>
                    
                    </div>
                    <span *ngIf="loading && !sortBool">
                        <mat-spinner style="margin: auto;margin-top: 50px;" class="orange-spinner"></mat-spinner>
                    </span>

                        <mat-paginator #paginator
                        [length] = "resultsLength"                                 
                        [pageSize]="apirequest.pageSize"
                        [pageSizeOptions]="[10, 25, 100]"
                        (page)="getPageDetails($event)">
                        </mat-paginator>
                                
                    </div>
                      

                    </div>
                </fuse-card>
            </div>
        </div>
     
    </div>
   
    <mat-sidenav #sidenav mode="over" backdrop="true" class="example-sidenav" [ngStyle]="{ 'width.%': sidenavWidth }"
        opened="false" position="end">
        <!-- Form Title -->
        <mat-toolbar class="mat-accent m-0 mail-compose-dialog">
            <mat-toolbar-row fxFlex fxLayout="row" fxLayoutAlign="space-between center"
                style="background: #941C3C;color: white;">
                <span class="title dialog-title">{{title}}</span>
                <div class="flex items-center pl-2 ml-auto space-x-0.5 sm:space-x-2">
                    <button mat-icon-button (click)="sidenav.toggle();" aria-label="Close dialog">
                        <mat-icon>close</mat-icon>
                    </button>
                </div>
            </mat-toolbar-row>
        </mat-toolbar>
        <!-- Form Title -->
        <!-- <div class="porfimage">
<img src="/assets/managemyunit/property-manager.png">
</div> -->
        <mat-dialog-content class="m-0 form formGroup h-auto" fusePerfectScrollbar>

            <form [formGroup]="questionform" fxFlex class="event-form w-100-p">
                <div fxLayout="column" class="p-20" style="padding: 1rem !important;">

                    <mat-form-field style="width: 30%" appearance="outline">
                        <mat-label> {{t('Select Course')}}</mat-label>
                        <mat-select  formControlName="courseId">
                            <mat-option *ngFor="let item of CourseList" [value]="item.id">{{item.courseName}}</mat-option>
                        </mat-select>
                        <mat-error>{{t('Course is required')}}</mat-error>
                    </mat-form-field>&nbsp;&nbsp;
                    <!-- <mat-form-field style="width: 30%" appearance="outline">
                        <mat-label>{{t('Select Language')}}</mat-label>
                        <mat-select formControlName="examLanguage">
                            <mat-option *ngFor="let item of examFullMarks"
                            [value]="item.value" >{{item.value}}</mat-option>
                        </mat-select>
                        <mat-error> {{t('Language is required')}} </mat-error>
                    </mat-form-field>&nbsp;&nbsp; -->
                    <!-- <mat-form-field style="width: 100%;" appearance="outline">
                        <mat-label>No. of Exam Question</mat-label>
                        <input matInput formControlName="sessionExamNoQuestion" type="number">
                    </mat-form-field> -->
                    <mat-form-field style="width: 30%" appearance="outline">
                        <mat-label> {{t('Exam Name')}}</mat-label>
                        <input matInput formControlName="title">
                        <mat-error>{{t('Exam is required')}}</mat-error>
                    </mat-form-field>&nbsp;&nbsp;
                    <mat-form-field style="width: 30%" appearance="outline">
                        <mat-label> {{t('Exam Duration')}}</mat-label>
                        <input matInput formControlName="examDuration" type="number" [min]="0">
                        <mat-error>{{t('Exam Duration is required')}}</mat-error>
                    </mat-form-field>&nbsp;&nbsp;
                    <mat-form-field style="width: 30%" appearance="outline">
                        <mat-label> {{t('Exam Total Marks')}} </mat-label>
                        <input matInput formControlName="examFullMarks" type="number" [min]="0">
                        <mat-error>{{t('Exam Total Marks is required')}}</mat-error>
                    </mat-form-field>&nbsp;&nbsp;

                    <mat-form-field style="width: 30%"  appearance="outline">
                        <mat-label>{{t('No of Question')}}</mat-label>
                        <input matInput formControlName="examNoQuestion" type="number" [min]="0" readonly>
                        <mat-error> {{t('No of Question is required')}}</mat-error>
                    </mat-form-field>&nbsp;&nbsp;

                    <mat-form-field style="width: 30%" appearance="outline">
                        <mat-label>{{t('Exam Start Date')}} </mat-label>
                        <input matInput [matDatepicker]="date11" [min]="todayDate" formControlName="examStartOn">
                        <mat-error> {{t('Exam Start Date is required')}}</mat-error>
                        <mat-datepicker-toggle matSuffix [for]="date11">
                        </mat-datepicker-toggle>
                        <mat-datepicker #date11></mat-datepicker>
                        <!-- <mat-error>Exam Start Date is Required</mat-error>          -->
                    </mat-form-field>&nbsp;&nbsp;

                    <mat-form-field style="width: 30%"  appearance="outline">
                        <mat-label>{{t('Exam End Date')}}</mat-label>
                        <input matInput [matDatepicker]="date1" [min]="todayDate" formControlName="examEndOn">
                        <mat-error>{{t('Exam End Date is required')}}</mat-error>
                        <mat-datepicker-toggle matSuffix [for]="date1">
                        </mat-datepicker-toggle>
                        <mat-datepicker #date1></mat-datepicker>
                    </mat-form-field>&nbsp;&nbsp;

                    <mat-form-field style="width: 30%" appearance="outline">
                        <mat-label>{{t('Exam Start Time')}}</mat-label>
                        <input matInput [ngxTimepicker]="fulltime1" formControlName="examStartTimeOn" [format]="12">
                        <ngx-material-timepicker-toggle matSuffix [for]="fulltime1"></ngx-material-timepicker-toggle>
                    </mat-form-field>
                    <ngx-material-timepicker #fulltime1></ngx-material-timepicker>
                    &nbsp;
                    <mat-form-field style="width: 30%" appearance="outline">
                        <mat-label>{{t('Exam End Time')}}</mat-label>
                        <input matInput [ngxTimepicker]="fulltime2" formControlName="examEndTimeOn" [format]="12">
                        <ngx-material-timepicker-toggle matSuffix [for]="fulltime2"></ngx-material-timepicker-toggle>
                    </mat-form-field>

                    <ngx-material-timepicker #fulltime2></ngx-material-timepicker>

                    <mat-form-field style="width: 80%;" appearance="outline">
                        <mat-label>{{t('Exam Description')}}</mat-label>
                        <!-- <input #input2 matInput formControlName="description" maxlength="1000"> -->
                        <textarea #input2 matInput rows="2" formControlName="description" maxlength="1000"></textarea>
                        <mat-hint align="end">{{input2.value?.length || 0}}/1000</mat-hint>
                    </mat-form-field>

                </div>
            </form>

        </mat-dialog-content>
        <div mat-dialog-actions fxLayoutAlign="end center" class="m-0 p-6 " fxLayout="row">
            <!-- Submit & Reset Button -->
            <button matTooltip="Reset" (click)="questionform.reset()" aria-label="Reset" mat-raised-button class="mr-4">
                <span>{{t('CLEAR')}}</span>
            </button>
            <button [disabled]="!questionform.valid||questionform.get('courseId').value == '' || questionform.get('examStartOn').value=='' || questionform.get('examEndOn').value=='' " type="submit" mat-raised-button color="accent" aria-label="Submit" (click)="submit(questionform)"
                matTooltip="Submit"><span> {{t('SUBMIT')}}</span></button>
            <!-- Submit & Reset Button -->
        </div>
    </mat-sidenav>
   
</mat-sidenav-container>
<ng-template #content>
    <h2 mat-dialog-title *transloco="let t; read: 'COURSE'" >{{t('Delete Confirmation')}}</h2>
    <div class="modal-header">
        <a href="javascript:void(0);" class="right_note" (click)="modalReference.close()"  style="color:#dc3545"><i class="fa fa-close"></i></a>
    </div>
    <div class="modal-body" *transloco="let t; read: 'COURSE'">
        <p>{{t('Are you sure you want to delete this record?')}}</p>
    </div>
    <div class="col lg-12" *transloco="let t; read: 'COURSE'">
        <br>
        <button (click)="DeleteExam();modalReference.close()"  mat-flat-button="" matdialogclose="" mat-raised-button color="accent" style="float: right;"
            class="mdc-button mdc-button--unelevated mat-mdc-unelevated-button mat-unthemed mat-mdc-button-base"
            type="button"><span class="mat-mdc-button-persistent-ripple mdc-button__ripple"></span><span
                class="mdc-button__label"> {{t('Delete')}} </span><span
                class="mat-mdc-focus-indicator"></span><span matripple=""
                class="mat-ripple mat-mdc-button-ripple"></span><span
                class="mat-mdc-button-touch-target"></span></button>


        <button (click)="modalReference.close()" _ngcontent-iac-c131="" mat-raised-button=""
            mat-flat-button="" matdialogclose="" type="button"
            class="mat-focus-indicator mdc-button mdc-button--unelevated mat-mdc-unelevated-button mat-unthemed mat-mdc-button-base mat-flat-button mat-raised-button mat-button-base"
            style="float: right;margin-right: 20px;"><span class="mat-button-wrapper"><span
                    _ngcontent-iac-c131=""
                    class="mat-mdc-button-persistent-ripple mdc-button__ripple"></span><span
                    _ngcontent-iac-c131="" class="mdc-button__label"> {{t('Cancel')}} </span><span
                    _ngcontent-iac-c131="" class="mat-mdc-focus-indicator"></span><span
                    _ngcontent-iac-c131="" matripple=""
                    class="mat-ripple mat-mdc-button-ripple"></span><span _ngcontent-iac-c131=""
                    class="mat-mdc-button-touch-target"></span></span><span matripple=""
                class="mat-ripple mat-button-ripple" ng-reflect-disabled="false" ng-reflect-centered="false"
                ng-reflect-trigger="[object HTMLButtonElement]"></span></button>

        <br>
        <br>

    </div>

</ng-template>

<ng-template #startexampopup>
    <h2 mat-dialog-title *transloco="let t; read: 'COURSE'" >{{t('Exam Confirmation')}}</h2>
    <div class="modal-header">
        <a href="javascript:void(0);" class="right_note" (click)="modalReference.close()"  style="color:#dc3545"><i class="fa fa-close"></i></a>
    </div>
    <div class="modal-body" *transloco="let t; read: 'COURSE'">
        <p>{{t('Are you sure you want to start the exam?')}}</p>
    </div>
    <div class="col lg-12" *transloco="let t; read: 'COURSE'">
        <br>
        <button (click)="startExam();modalReference.close()"  mat-flat-button="" matdialogclose="" mat-raised-button color="accent" style="float: right;"
            class="mdc-button mdc-button--unelevated mat-mdc-unelevated-button mat-unthemed mat-mdc-button-base"
            type="button"><span class="mat-mdc-button-persistent-ripple mdc-button__ripple"></span><span
                class="mdc-button__label"> {{t('Start')}} </span><span
                class="mat-mdc-focus-indicator"></span><span matripple=""
                class="mat-ripple mat-mdc-button-ripple"></span><span
                class="mat-mdc-button-touch-target"></span></button>


        <button (click)="modalReference.close()" _ngcontent-iac-c131="" mat-raised-button=""
            mat-flat-button="" matdialogclose="" type="button"
            class="mat-focus-indicator mdc-button mdc-button--unelevated mat-mdc-unelevated-button mat-unthemed mat-mdc-button-base mat-flat-button mat-raised-button mat-button-base"
            style="float: right;margin-right: 20px;"><span class="mat-button-wrapper"><span
                    _ngcontent-iac-c131=""
                    class="mat-mdc-button-persistent-ripple mdc-button__ripple"></span><span
                    _ngcontent-iac-c131="" class="mdc-button__label"> {{t('Cancel')}} </span><span
                    _ngcontent-iac-c131="" class="mat-mdc-focus-indicator"></span><span
                    _ngcontent-iac-c131="" matripple=""
                    class="mat-ripple mat-mdc-button-ripple"></span><span _ngcontent-iac-c131=""
                    class="mat-mdc-button-touch-target"></span></span><span matripple=""
                class="mat-ripple mat-button-ripple" ng-reflect-disabled="false" ng-reflect-centered="false"
                ng-reflect-trigger="[object HTMLButtonElement]"></span></button>

        <br>
        <br>

    </div>

</ng-template>
